{"version":3,"sources":["server/_service/login.route.ts"],"names":[],"mappings":";;AACA,mCAAoD;AACpD,yCAAmD;AACnD,0CAAiD;AAEpC,QAAA,KAAK,GAAG,gBAAM,EAAE,CAAC;AAE9B,aAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,qBAAa,CAAC;IAEjC,MAAM,EAAE,EAAE,YAAY,EAAE,KAAK,EAAE;CAEhC,CAAC,EAAC,UAAC,OAAgB,EAAE,QAAkB;IAEtC,iBAAS,CAAC,OAAO,CAAC;QAChB,IAAI,EAAE,CAAC;gBACL,QAAQ,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;aAC5B,EAAC;gBACA,KAAK,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;aACzB,EAAC;gBACA,GAAG,EAAE,CAAC;wBACJ,KAAK,EAAE,OAAO,CAAC,IAAI,CAAC,KAAK;qBAC1B,EAAC;wBACA,QAAQ,EAAE,OAAO,CAAC,IAAI,CAAC,KAAK;qBAC7B,CAAC;aACH,EAAC;gBACA,QAAQ,EAAE,OAAO,CAAC,IAAI,CAAC,QAAQ;aAChC,CAAC;KACH,EAAE,UAAC,KAAU,EAAE,IAAW;QAEzB,EAAE,CAAC,CAAC,KAAK,CAAC;YACR,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QAE3D,EAAE,CAAC,CAAC,IAAI,CAAC;YACP,QAAQ,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;QAChE,IAAI;YACF,QAAQ,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;IAEtC,CAAC,CAAC,CAAC;AAEL,CAAC,CAAC,CAAC","file":"login.route.js","sourcesContent":["\nimport { Router, Response, Request } from 'express';\nimport { IUser, UserModel } from '../_model/index';\nimport { authorization } from '../_common/index';\n\nexport const login = Router();\n\nlogin.post('/login', authorization({\n\n  global: { mustBeLogged: false }\n\n}),(request: Request, response: Response) => {\n\n  UserModel.findOne({\n    $and: [{\n      username: { $exists: true }\n    },{\n      email: { $exists: true }\n    },{\n      $or: [{\n        email: request.body.login\n      },{\n        username: request.body.login\n      }]\n    },{\n      password: request.body.password\n    }],\n  }, (error: any, user: IUser) => {\n\n    if (error)\n      return response.handler({ DBError: true, error: error });\n\n    if (user)\n      response.handler({ type: true, data: { token: user.token } });\n    else\n      response.handler({ type: false });\n\n  });\n\n});\n"]}